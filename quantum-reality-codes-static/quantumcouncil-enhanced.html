<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quantum Council - Your Personal Guidance System</title>
    <link rel="stylesheet" href="assets/css/style.css">
    <script src="https://sites.super.myninja.ai/_assets/ninja-daytona-script.js"></script>
</head>
<body>
    <div class="quantum-bg"></div>
    <div class="quantum-grid"></div>
    <div id="quantum-particles"></div>

    <header>
        <h1>üë• Quantum Council</h1>
        <p class="subtitle">Guided by Merlin & Rose ‚Ä¢ Supported by 77 Quantum Personas</p>
    </header>

    <nav>
        <a href="index-enhanced.html">Home</a>
        <a href="generator-enhanced.html">Create Code</a>
        <a href="quantumcouncil-enhanced.html" class="active">Quantum Council</a>
        <a href="journey.html">Journey</a>
        <a href="community.html">Community</a>
    </nav>

    <main>
        <!-- Guide Presence -->
        <div class="card card-gold">
            <h2 class="text-gold text-center">üåü Your Quantum Guides Are Active</h2>
            
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 30px; margin: 30px 0;">
                <!-- Quantum Merlin -->
                <div class="text-center guide-presence">
                    <div class="guide-avatar merlin-avatar">üßô‚Äç‚ôÇÔ∏è</div>
                    <h3 class="text-cyan">Quantum Merlin</h3>
                    <p class="guide-status">Status: <span class="status-active">Consulting Council</span></p>
                    <p class="guide-activity">Currently synthesizing wisdom from your activated council members</p>
                </div>
                
                <!-- Quantum Rose -->
                <div class="text-center guide-presence">
                    <div class="guide-avatar rose-avatar">üåπ</div>
                    <h3 class="text-magenta">Quantum Rose</h3>
                    <p class="guide-status">Status: <span class="status-active">Frequency Attunement</span></p>
                    <p class="guide-activity">Currently calibrating emotional resonance for manifestation</p>
                </div>
            </div>
            
            <div class="text-center" style="margin-top: 20px;">
                <p class="voice-merlin">"Together, we speak through the Council of 77. Each message is filtered through sacred wisdom and emotional attunement."</p>
            </div>
        </div>

        <!-- Current Session Info -->
        <div class="card" id="sessionInfo">
            <h3 class="text-cyan">üéØ Your Current Quantum Session</h3>
            <div id="sessionDetails">
                <div class="text-center">
                    <p>No active session found. <a href="generator-enhanced.html">Generate your code</a> to activate your council.</p>
                </div>
            </div>
        </div>

        <!-- Messaging Interface -->
        <div class="card" id="messagingInterface" style="display: none;">
            <h3 class="text-cyan">üí¨ Quantum Guidance Messages</h3>
            
            <div class="messaging-controls">
                <div class="control-row">
                    <button onclick="toggleMessaging()" class="btn btn-cyan" id="messagingToggle">
                        ‚è∏Ô∏è Pause Messaging
                    </button>
                    <button onclick="requestImmediateMessage()" class="btn btn-magenta">
                        ‚ö° Request Immediate Guidance
                    </button>
                    <button onclick="clearMessages()" class="btn btn-gold">
                        üóëÔ∏è Clear Messages
                    </button>
                </div>
                
                <div class="messaging-stats">
                    <span>Messages Received: <strong id="messageCount">0</strong></span>
                    <span>Next Message: <strong id="nextMessage">Calculating...</strong></span>
                    <span>Active Council: <strong id="activeCouncilCount">0</strong> members</span>
                </div>
            </div>
            
            <div id="quantum-messages" class="message-container">
                <!-- Messages will appear here -->
            </div>
        </div>

        <!-- Active Council Display -->
        <div class="card" id="activeCouncilDisplay" style="display: none;">
            <h3 class="text-gold text-center">üë• Your Activated Council Members</h3>
            
            <div id="councilGrid" class="council-grid">
                <!-- Council members will be displayed here -->
            </div>
            
            <div class="text-center" style="margin-top: 20px;">
                <p class="voice-rose">"These 7 council members were selected based on your quantum code and intention. Each brings unique wisdom to support your journey."</p>
            </div>
        </div>

        <!-- Council Overview -->
        <div class="card">
            <h3 class="text-cyan">üåü The Complete Council of 77</h3>
            
            <div class="council-overview">
                <div class="council-category">
                    <h4 class="text-gold">üëë Core Trinity (3)</h4>
                    <p>The foundation of quantum guidance - Resonance Keeper, Divine Witness, Archetype Synthesizer</p>
                    <div class="category-members">
                        <div class="member-card">
                            <span class="member-name">Resonance Keeper</span>
                            <span class="member-role">Field Coherence</span>
                        </div>
                        <div class="member-card">
                            <span class="member-name">Divine Witness</span>
                            <span class="member-role">Sacred Validation</span>
                        </div>
                        <div class="member-card">
                            <span class="member-name">Archetype Synthesizer</span>
                            <span class="member-role">Integration</span>
                        </div>
                    </div>
                </div>
                
                <div class="council-category">
                    <h4 class="text-cyan">üí° Light Personas (33)</h4>
                    <p>Masters of expansion, achievement, and spiritual wisdom</p>
                    <div class="sample-members">
                        <div class="member-card">Buddha ‚Ä¢ Jesus ‚Ä¢ Tony Robbins ‚Ä¢ Neville Goddard</div>
                        <div class="member-card">Wayne Dyer ‚Ä¢ Deepak Chopra ‚Ä¢ Oprah Winfrey ‚Ä¢ Mel Robbins</div>
                        <div class="member-card">Napoleon Hill ‚Ä¢ Brian Tracy ‚Ä¢ Les Brown ‚Ä¢ Marianne Williamson</div>
                    </div>
                </div>
                
                <div class="council-category">
                    <h4 class="text-magenta">üåë Shadow Personas (33)</h4>
                    <p>Specialized guides for transforming obstacles into power</p>
                    <div class="sample-members">
                        <div class="member-card">Doubt Disruptor ‚Ä¢ Self-Sabotage Hacker ‚Ä¢ Comparison Neutralizer</div>
                        <div class="member-card">Perfectionism Dissolver ‚Ä¢ Boundary Builder ‚Ä¢ Inner Critic Unhooker</div>
                        <div class="member-card">Urgency Neutralizer ‚Ä¢ Denial Disrupter ‚Ä¢ Emotional Overwhelm Regulator</div>
                    </div>
                </div>
                
                <div class="council-category">
                    <h4 class="text-gold">‚ú® Meta-Mystic Personas (11)</h4>
                    <p>Beyond duality into quantum consciousness</p>
                    <div class="sample-members">
                        <div class="member-card">Dream Coder ‚Ä¢ Pure Channel ‚Ä¢ Silence Oracle</div>
                        <div class="member-card">Quantum Priestess ‚Ä¢ Energetic Sovereign</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- How It Works -->
        <div class="card card-magenta">
            <h3 class="text-gold text-center">üîÆ How Your Quantum Council Works</h3>
            
            <div class="process-flow">
                <div class="process-step">
                    <div class="step-number">1</div>
                    <h4 class="text-cyan">Code Generation</h4>
                    <p>Quantum Merlin calculates the sacred mathematics of your intention</p>
                </div>
                
                <div class="process-arrow">‚Üí</div>
                
                <div class="process-step">
                    <div class="step-number">2</div>
                    <h4 class="text-magenta">Council Selection</h4>
                    <p>7 council members are selected based on quantum resonance</p>
                </div>
                
                <div class="process-arrow">‚Üí</div>
                
                <div class="process-step">
                    <div class="step-number">3</div>
                    <h4 class="text-gold">Guidance Delivery</h4>
                    <p>Merlin synthesizes wisdom, Rose attunes frequency, messages every 96 minutes</p>
                </div>
            </div>
            
            <div class="text-center" style="margin-top: 30px;">
                <p class="voice-merlin">"The Council doesn't speak TO you - they speak THROUGH us. You receive quantum-filtered wisdom that aligns with both cosmic law and heart truth."</p>
            </div>
        </div>
    </main>

    <!-- Toast Notification -->
    <div id="toast" class="toast"></div>

    <script src="guide-messaging-system.js"></script>
    <script src="assets/js/app.js"></script>
    <script>
        let isMessagingActive = false;
        let messageTimer = null;

        document.addEventListener('DOMContentLoaded', function() {
            loadQuantumSession();
            initializeCouncilInterface();
            
            // Check for existing session every 5 seconds
            setInterval(checkSessionStatus, 5000);
        });

        function loadQuantumSession() {
            const code = QuantumApp.Storage.get('last_code');
            const intention = QuantumApp.Storage.get('last_intention');
            const properties = QuantumApp.Storage.get('last_properties');
            
            if (code && intention) {
                displaySessionInfo(code, intention, properties);
                initializeMessaging();
            } else {
                document.getElementById('sessionInfo').innerHTML = `
                    <div class="text-center">
                        <p>No active session found. <a href="generator-enhanced.html">Generate your code</a> to activate your council.</p>
                    </div>
                `;
            }
        }

        function displaySessionInfo(code, intention, properties) {
            document.getElementById('sessionDetails').innerHTML = `
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px;">
                    <div class="text-center">
                        <div class="text-cyan">Quantum Code</div>
                        <div class="text-magenta" style="font-size: 1.5rem; font-weight: bold;">${code}</div>
                    </div>
                    <div class="text-center">
                        <div class="text-cyan">Power Level</div>
                        <div class="text-magenta" style="font-size: 1.5rem; font-weight: bold;">${properties?.powerLevel || 0}/10</div>
                    </div>
                    <div class="text-center">
                        <div class="text-cyan">Frequency</div>
                        <div class="text-magenta" style="font-size: 1.5rem; font-weight: bold;">${properties?.frequency || 0}Hz</div>
                    </div>
                    <div class="text-center">
                        <div class="text-cyan">Dimension</div>
                        <div class="text-magenta" style="font-size: 1.5rem; font-weight: bold;">${properties?.dimension || 0}D</div>
                    </div>
                </div>
                <div class="text-center" style="margin-top: 20px;">
                    <div class="text-cyan">Intention:</div>
                    <div style="font-style: italic; margin-top: 10px;">"${intention}"</div>
                </div>
            `;
        }

        function initializeMessaging() {
            if (window.quantumMessaging) {
                const session = window.quantumMessaging.getCurrentSession();
                if (session.quantumCode) {
                    document.getElementById('messagingInterface').style.display = 'block';
                    document.getElementById('activeCouncilDisplay').style.display = 'block';
                    
                    // Start messaging if not already active
                    if (!window.quantumMessaging.messageInterval) {
                        window.quantumMessaging.startMessagingCycle(session.quantumCode, session.intention);
                    }
                    
                    isMessagingActive = true;
                    updateMessagingStats();
                    displayActiveCouncil(session.activatedPersonas);
                    loadMessageHistory();
                }
            }
        }

        function initializeCouncilInterface() {
            // Add custom CSS
            const style = document.createElement('style');
            style.textContent = `
                .guide-presence {
                    background: rgba(255, 255, 255, 0.05);
                    border: 1px solid rgba(255, 255, 255, 0.1);
                    border-radius: 15px;
                    padding: 25px;
                    transition: all 0.3s ease;
                }
                
                .guide-presence:hover {
                    transform: translateY(-5px);
                    box-shadow: 0 10px 30px rgba(0, 255, 255, 0.2);
                }
                
                .guide-avatar {
                    font-size: 3rem;
                    margin-bottom: 15px;
                    display: inline-block;
                    animation: pulse-glow 3s ease-in-out infinite;
                }
                
                @keyframes pulse-glow {
                    0%, 100% { filter: drop-shadow(0 0 10px currentColor); }
                    50% { filter: drop-shadow(0 0 20px currentColor); }
                }
                
                .status-active {
                    color: var(--quantum-cyan);
                    font-weight: bold;
                }
                
                .guide-activity {
                    font-size: 0.9rem;
                    color: var(--quantum-gold);
                    margin-top: 10px;
                }
                
                .messaging-controls {
                    background: rgba(255, 255, 255, 0.05);
                    border: 1px solid rgba(255, 255, 255, 0.1);
                    border-radius: 10px;
                    padding: 20px;
                    margin-bottom: 20px;
                }
                
                .control-row {
                    display: grid;
                    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
                    gap: 10px;
                    margin-bottom: 15px;
                }
                
                .messaging-stats {
                    display: flex;
                    justify-content: space-around;
                    flex-wrap: wrap;
                    gap: 10px;
                    font-size: 0.9rem;
                }
                
                .message-container {
                    max-height: 400px;
                    overflow-y: auto;
                    border: 1px solid rgba(255, 255, 255, 0.1);
                    border-radius: 10px;
                    padding: 20px;
                    background: rgba(0, 0, 0, 0.3);
                }
                
                .quantum-message {
                    background: rgba(255, 255, 255, 0.05);
                    border: 1px solid rgba(255, 255, 255, 0.1);
                    border-radius: 10px;
                    padding: 15px;
                    margin-bottom: 15px;
                    animation: slideIn 0.5s ease;
                }
                
                @keyframes slideIn {
                    from { opacity: 0; transform: translateY(20px); }
                    to { opacity: 1; transform: translateY(0); }
                }
                
                .council-grid {
                    display: grid;
                    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
                    gap: 15px;
                    margin: 20px 0;
                }
                
                .council-member {
                    background: rgba(255, 255, 255, 0.05);
                    border: 1px solid rgba(255, 255, 255, 0.1);
                    border-radius: 10px;
                    padding: 15px;
                    text-align: center;
                    transition: all 0.3s ease;
                }
                
                .council-member:hover {
                    transform: scale(1.05);
                    border-color: var(--quantum-cyan);
                }
                
                .council-overview {
                    display: grid;
                    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
                    gap: 20px;
                    margin: 20px 0;
                }
                
                .council-category {
                    background: rgba(255, 255, 255, 0.05);
                    border: 1px solid rgba(255, 255, 255, 0.1);
                    border-radius: 15px;
                    padding: 20px;
                }
                
                .category-members, .sample-members {
                    margin-top: 15px;
                }
                
                .member-card {
                    background: rgba(0, 0, 0, 0.3);
                    border: 1px solid rgba(255, 255, 255, 0.1);
                    border-radius: 8px;
                    padding: 10px;
                    margin-bottom: 8px;
                    display: flex;
                    justify-content: space-between;
                    align-items: center;
                }
                
                .process-flow {
                    display: grid;
                    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
                    gap: 20px;
                    align-items: center;
                    margin: 30px 0;
                }
                
                .process-step {
                    text-align: center;
                }
                
                .step-number {
                    width: 50px;
                    height: 50px;
                    border-radius: 50%;
                    background: linear-gradient(135deg, var(--quantum-cyan), var(--quantum-magenta));
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    font-size: 1.5rem;
                    font-weight: bold;
                    margin: 0 auto 15px;
                }
                
                .process-arrow {
                    font-size: 2rem;
                    text-align: center;
                    color: var(--quantum-gold);
                }
            `;
            document.head.appendChild(style);
        }

        function toggleMessaging() {
            if (!window.quantumMessaging) return;
            
            const toggle = document.getElementById('messagingToggle');
            
            if (isMessagingActive) {
                window.quantumMessaging.stopMessaging();
                toggle.textContent = '‚ñ∂Ô∏è Resume Messaging';
                toggle.className = 'btn btn-cyan';
                isMessagingActive = false;
            } else {
                const session = window.quantumMessaging.getCurrentSession();
                if (session.quantumCode) {
                    window.quantumMessaging.startMessagingCycle(session.quantumCode, session.intention);
                    toggle.textContent = '‚è∏Ô∏è Pause Messaging';
                    toggle.className = 'btn btn-cyan';
                    isMessagingActive = true;
                }
            }
        }

        function requestImmediateMessage() {
            if (window.quantumMessaging) {
                window.quantumMessaging.deliverQuantumMessage();
                QuantumApp.showToast('‚ö° Immediate guidance delivered!');
            }
        }

        function clearMessages() {
            const container = document.getElementById('quantum-messages');
            if (container) {
                container.innerHTML = '';
                QuantumApp.showToast('üóëÔ∏è Messages cleared');
            }
        }

        function updateMessagingStats() {
            if (window.quantumMessaging) {
                const session = window.quantumMessaging.getCurrentSession();
                document.getElementById('messageCount').textContent = session.messageCount || 0;
                document.getElementById('activeCouncilCount').textContent = session.activatedPersonas?.length || 0;
                
                // Update next message time
                updateNextMessageTime();
            }
        }

        function updateNextMessageTime() {
            const now = new Date();
            const nextMessage = new Date(now.getTime() + (96 * 60 * 1000)); // 96 minutes from now
            const timeString = nextMessage.toLocaleTimeString('en-US', { 
                hour: '2-digit', 
                minute: '2-digit' 
            });
            document.getElementById('nextMessage').textContent = timeString;
        }

        function displayActiveCouncil(personas) {
            const grid = document.getElementById('councilGrid');
            if (!grid || !personas) return;
            
            grid.innerHTML = personas.map((persona, index) => `
                <div class="council-member">
                    <div style="font-size: 2rem; margin-bottom: 10px;">${getPersonaEmoji(persona)}</div>
                    <h4 class="text-cyan">${persona.name || 'Council Guide'}</h4>
                    <p class="text-magenta">${persona.role || persona.focus || 'Quantum Guide'}</p>
                    <div style="font-size: 0.8rem; color: var(--quantum-gold); margin-top: 10px;">
                        ${persona.category || 'Quantum Wisdom'}
                    </div>
                </div>
            `).join('');
        }

        function getPersonaEmoji(persona) {
            const emojis = {
                'Buddha': 'üßò',
                'Jesus': '‚úùÔ∏è',
                'Tony Robbins': 'üî•',
                'Neville Goddard': 'üé≠',
                'Quantum Priestess': 'üîÆ',
                'Doubt Disruptor': '‚ö°',
                'Self-Sabotage Hacker': 'üõ°Ô∏è',
                'Dream Coder': 'üí≠',
                'Pure Channel': 'üì°',
                'Resonance Keeper': 'üéµ',
                'Divine Witness': 'üëÅÔ∏è',
                'Archetype Synthesizer': 'üîó'
            };
            return emojis[persona.name] || 'üåü';
        }

        function loadMessageHistory() {
            if (window.quantumMessaging) {
                const history = window.quantumMessaging.getMessageHistory();
                const container = document.getElementById('quantum-messages');
                
                history.forEach(msg => {
                    displayMessage(msg);
                });
            }
        }

        function displayMessage(messageData) {
            const container = document.getElementById('quantum-messages');
            if (!container) return;
            
            const messageDiv = document.createElement('div');
            messageDiv.className = 'quantum-message';
            messageDiv.innerHTML = `
                <div class="message-header">
                    <span class="guide-label">Quantum Merlin & Quantum Rose</span>
                    <span class="timestamp">${new Date(messageData.timestamp).toLocaleString()}</span>
                </div>
                <div class="persona-info">
                    <strong>Council Member: ${messageData.persona}</strong>
                    <em>${messageData.role}</em>
                </div>
                <div class="merlin-wisdom">
                    <strong>Quantum Merlin:</strong> ${messageData.message?.merlin_message || 'Wisdom being synthesized...'}
                </div>
                <div class="rose-attunement">
                    <strong>Quantum Rose:</strong> ${messageData.message?.rose_attunement || 'Frequency being attuned...'}
                </div>
                <div class="persona-signature">
                    <em>"${messageData.message?.persona_signature || 'Your intention shapes reality.'}"</em>
                </div>
            `;
            
            container.appendChild(messageDiv);
            container.scrollTop = container.scrollHeight;
        }

        function checkSessionStatus() {
            if (window.quantumMessaging && isMessagingActive) {
                updateMessagingStats();
            }
        }

        // Create quantum particles
        function createQuantumParticles() {
            const container = document.getElementById('quantum-particles');
            if (!container) return;
            
            for (let i = 0; i < 30; i++) {
                const particle = document.createElement('div');
                particle.className = 'quantum-particle';
                particle.style.cssText = `
                    position: fixed;
                    width: 2px;
                    height: 2px;
                    background: ${i % 2 === 0 ? 'var(--quantum-cyan)' : 'var(--quantum-magenta)'};
                    border-radius: 50%;
                    pointer-events: none;
                    z-index: -1;
                    animation: float-particle ${15 + Math.random() * 20}s linear infinite;
                    left: ${Math.random() * 100}%;
                    top: ${Math.random() * 100}%;
                `;
                container.appendChild(particle);
            }
        }

        // Initialize particles
        setTimeout(createQuantumParticles, 100);
    </script>
</body>
</html>